!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();let e=null,t={};async function n(){try{!function(){try{const e=localStorage.getItem("scripCalculatorOrder");e&&(t=JSON.parse(e),console.log("Order restored from localStorage"))}catch(e){console.error("Failed to load order from storage:",e)}}();const n=await async function(e,t=3,n=1e3){for(let i=0;i<t;i++)try{const t=await fetch(e);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t}catch(a){if(i===t-1)throw a;console.warn(`Fetch attempt ${i+1} failed, retrying in ${n}ms...`),await new Promise(e=>setTimeout(e,n)),n*=2}}("/menu.json");e=await n.json(),document.getElementById("categories").innerHTML=e.categories.map(e=>`\n        <div class="category">\n            <button class="category-header" data-category="${e.name}" aria-expanded="false" aria-controls="${e.name}">\n                <div class="left">\n                    <span class="icon" aria-hidden="true">${e.icon}</span>\n                    ${e.name}\n                </div>\n                <div class="total" id="total-${e.name}" aria-live="polite">0 scrip</div>\n            </button>\n            <div id="${e.name}" class="items hidden" role="region" aria-label="${e.name} items">\n                ${e.items.map((t,n)=>`\n                    <div class="item-row">\n                        <div class="item-info">\n                            <span class="item-name">\n                                ${t.name}\n                                ${0===n&&t.description?`\n                                    <br><span class="item-description">${t.description}</span>\n                                `:""}\n                            </span>\n                            <span class="scrip-amount">${t.scrip} scrip</span>\n                        </div>\n                        <div class="quantity-control" role="group" aria-label="Quantity for ${t.name}">\n                            <button class="quantity-btn minus" onclick="adjustQuantity('${t.id}', -1)" aria-label="Decrease quantity">−</button>\n                            <input type="number"\n                                class="quantity-input"\n                                data-item-id="${t.id}"\n                                data-category="${e.name}"\n                                min="0"\n                                value="0"\n                                onchange="updateQuantity('${t.id}', this.value)"\n                                inputmode="numeric"\n                                pattern="[0-9]*"\n                                aria-label="Quantity for ${t.name}">\n                            <button class="quantity-btn plus" onclick="adjustQuantity('${t.id}', 1)" aria-label="Increase quantity">+</button>\n                        </div>\n                    </div>\n                `).join("")}\n            </div>\n        </div>\n    `).join(""),document.querySelectorAll(".category-header").forEach(t=>{t.addEventListener("click",()=>{!function(t,n){const i=document.getElementById(t),o=document.getElementById(`desc-${t}`),r=i.classList.contains("hidden");i.classList.toggle("hidden"),n.classList.toggle("collapsed"),n.setAttribute("aria-expanded",r?"true":"false"),o&&(o.style.display=i.classList.contains("hidden")?"none":"block");const s=e.categories.find(e=>e.name===t).items,c=a(s),l=document.getElementById(`total-${t}`);l.textContent=`${c} scrip`}(t.dataset.category,t)})}),Object.entries(t).forEach(([e,t])=>{if(t>0){const n=document.querySelector(`input[data-item-id="${e}"]`);n&&(n.value=t)}}),e.categories.forEach(e=>{const t=a(e.items),n=document.getElementById(`total-${e.name}`);n&&(n.textContent=`${t} scrip`)}),function(){let n=0;Object.entries(t).forEach(([e,t])=>{const a=i(e);a&&(n+=a.scrip*t)});const a=(Math.ceil(n/e.scripInfo.scripPerSheet)*e.scripInfo.scripSheetCost).toFixed(2);document.getElementById("total-scrip").textContent=n,document.getElementById("total-cost").textContent=a}(),function(){const e=document.getElementById("summary-content"),n=Object.entries(t).filter(([e,t])=>t>0).map(([e,t])=>{const n=i(e);return{name:n.name,quantity:t,scrip:n.scrip}});0!==n.length?e.innerHTML=n.map(e=>`\n            <div class="summary-item">\n                <span class="summary-item-name">${e.name}</span>\n                <span class="summary-item-quantity">${e.quantity}× (${e.quantity*e.scrip} scrip)</span>\n            </div>\n        `).join(""):e.innerHTML='<div class="empty-message">No items added yet</div>'}()}catch(n){console.error("Failed to initialize app:",n),document.body.innerHTML='<div class="error" role="alert">Failed to load menu data. Please check your connection and <a href="javascript:location.reload()">refresh the page</a>.</div>'}}function a(e){return Object.entries(t).reduce((t,[n,a])=>{const i=e.find(e=>e.id===n);return t+(i?i.scrip*a:0)},0)}function i(t){for(const n of e.categories){const e=n.items.find(e=>e.id===t);if(e)return e}return null}document.addEventListener("DOMContentLoaded",()=>{n()});
